{% extends "base.html" %}

{% block page_title %}
  {{movie.title}}
{% endblock page_title %}

{% block content %}

<div class="flex flex-col items-center bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
<h2 class="font-bold">{{movie.title}}</h2>
<div class="flex items-center my-2">
  <div class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700">{{movie.year}}</div>
  <div class="bg-orange-400 text-white px-3 shadow-md py-1 rounded-full mx-4">{{movie.category}}</div>
  <div class="text-red-600">♥︎{{movie.rating}}</div>
</div>
<div class="my-2">Director:
  <div class="inline-block bg-white shadow-md rounded-full px-3 py-1 text-sm font-semibold text-gray-700">{{movie.director}}</div>
</div>
<div class="my-2">Cast: {% for i in movie.cast.all %} 
  <div class="inline-block bg-white shadow-md rounded-full px-3 py-1 text-sm font-semibold text-gray-700">{{i}}</div> {% endfor %}
</div>
<div class="flex">
  <a class="bg-blue-400 hover:bg-blue-600 text-white font-bold mt-4 py-2 px-4 rounded" href="{% url 'movies:update' movie.pk %}">Edit Movie</a>
  {% if user.is_authenticated %}
    {% include "mixins/fav_button.html" with obj=movie kind='movie' %}
    <a class="bg-green-400 hover:bg-green-600 text-white font-bold ml-5 mt-4 py-2 px-4 rounded" href="{% url 'reviews:movie' movie.pk %}">Make a Review</a> 
  {% endif %}
</div>

<h4 class="font-medium text-2xl my-5">Reviews</h4>
<div class="flex items-center">
    <div>
        <i class="fas fa-star text-green-400"></i>
        <span class="font-bold text-xl">︎︎♥︎ {{movie.rating}}</span>
    </div>
    <div class="h-5 w-px bg-gray-400 mx-5"></div>
    <div>
        <span class="font-bold text-xl mr-px">{{movie.reviews.count}}</span> 
        <span>review{{movie.reviews.count|pluralize}}</span>
    </div> 
</div>
{% for review in movie.reviews.all  %}
<div class="bg-white shadow-md rounded px-8 pt-6 pb-8 my-4">
  <div class="flex flex-col ml-5">
    <span class="font-medium text-lg mb-2">By: {{review.created_by}}</span>
    <span class="font-light text-gray-700">{{review.text}}
      {% if user == review.created_by %}
      <a class="mx-4" href="{% url "reviews:delete" review.pk movie.pk %}?kind=movie">❌</a>
      {% else %}
      {% endif %}
      </span>
    
  </div>
</div>
{% endfor %}
</div>
</div>

{% endblock content %}